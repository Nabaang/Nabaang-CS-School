# 정규화(Normalization)

## 이상현상(Anomaly)

이상현상이란 **릴레이션에 중복된 데이터가 존재**하여 릴레이션을 조작하는 과정에서 **데이터의 일관성**이 깨지는 경우이다. 종류에는 갱신 이상, 삭제 이상, 삽입 이상이 있다.

> 갱신 이상

일부 튜플만 데이터가 갱신되어 데이터의 일관성이 깨지는 경우

> 삭제 이상

튜플을 삭제하기 위해, 삭제되지 않아도 될 정보까지 삭제하는 경우

> 삽입 이상

튜플을 삽입하기 위해, 필요 없는 정보까지 삽입하는 경우(Ex) null 값 삽입)

## 정규화

RDB에서 릴레이션에 데이터의 중복이 있는 경우, 삽입, 삭제, 갱신 연산 과정에서 **이상현상**이 발생할 수 있다. 정규화란 이상현상을 방지하여 데이터의 일관성을 확보하기 위해 릴레이션을 두 개 이상의 릴레이션으로 분해하는 설계 기법이다.

## 정규화 기준

정규화를 할 때, 어떠한 기준으로 정규화를 하는지가 중요하다. 주로 함수 종속성이 기준으로 사용된다. 함수 종속성이란 특정 애트리뷰트가 다른 애트리뷰트의 **결정자** 인 경우이다. 여기서 결정자란, 다른 애트리뷰트를 고유하게 결정하는 하나 이상의 애트리뷰트를 의미한다. 만약, 애트리뷰트 A가 애트리뷰트 B의 결정자인 경우 `A->B`로 표현하며, B가 A에 함수적으로 종속된다고 말한다.

> 완전 함수적 종속

애트리뷰트 B가 애트리뷰트 A에 함수적으로 종속할 때, 애트리뷰트 B가 애트리뷰트 A의 부분집합에 종속되지 않는 경우이다. 예를 들어, `{A,B} → C`의 종속 관계를 가질 때 `A → C` 또는 `B → C`의 함수 종속 관계가 성립되면 안 된다.

> 부분 함수적 종속

애트리뷰트 B가 애트리뷰트 A에 함수적으로 종속할 때, 애트리뷰트 B가 애트리뷰트 **A의 부분집합에 종속되는 경우이다.**

> 이행적 종속

`A → B` 및 `B → C`의 함수적 종속 관계를 가질 때, `A → C`의 함수적 종속 관계가 성립하는 경우이다.

## 정규화의 종류

정규화 기법은 제1정규화, 제2정규화, 제3정규화, BCNF, 제4정규화, 제5정규화, 제6정규화 존재한다. 실무에서는 BCNF 까지만 정규화를 하는 경우가 많아, **제1정규화부터 BCNF**에 대한 정규화를 다루고자 한다.

> 제1정규화

릴레이션 R의 모든 애트리뷰트는 원자 값을 가져야 한다. 여기서 원자 값이란 하나의 튜플에서 각 애트리뷰트의 값의 개수가 오직 한 개를 가지는 경우이다.

> 제2정규화

제1정규화를 만족하면서, 기본키는 **완전 함수적 종속성**을 만족해야 한다.

> 제3정규화

제2정규화를 만족하면서, 애트리뷰트 간 **이행적 함수 종속**이 없어야 한다.

> BCNF

제3정규화를 만족하면서, 모든 결정자는 후보키에 해당돼야 한다. 즉, 후보키가 아닌데 결정자 인 애트리뷰트가 존재하면 안 된다.

## 정규화의 장단점

결국 정규화는 데이터의 일관성을 확보하기 위해 릴레이션을 분해하는 행위이다. 릴레이션을 분해하면 데이터의 일관성을 확보할 수 있고, 데이터의 중복을 방지, 이상 현상을 **어느 정도**는 해결할 수 있다. (**정규화를 한다고 해서 이상 현상을 완벽히 방지할 수는 없다.)**

하지만, 릴레이션을 분해 후 분해 전 정보를 얻기 위해서는 JOIN 연산이 추가적으로 수행해야 한다. 이는 성능 이슈로 이어질 수 있다. 결국은 구조의 안정성과 성능 간의 trade-off가 존재하기에 상황에 맞게 정규화를 적용해야 한다.

### Ref.

- [https://3months.tistory.com/193](https://3months.tistory.com/193)
- [https://yaboong.github.io/database/2018/03/10/database-normalization-2/](https://yaboong.github.io/database/2018/03/10/database-normalization-2/)
- [http://www.kocw.net/home/cview.do?cid=d549f8570583094b](http://www.kocw.net/home/cview.do?cid=d549f8570583094b)
